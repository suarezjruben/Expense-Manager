<section class="panel">
  <div class="toolbar">
    <h1>Transactions</h1>
    <label>
      Month
      <input type="month" [(ngModel)]="month" (change)="onMonthChanged()" />
    </label>
  </div>

  <p class="error" *ngIf="error">{{ error }}</p>
  <p *ngIf="loading">Loading...</p>

  <div class="grid">
    <article>
      <h2>Add Expense</h2>
      <form (ngSubmit)="addExpense()" #expenseFormRef="ngForm">
        <input name="expenseDate" type="date" [(ngModel)]="expenseForm.date" required />
        <input name="expenseAmount" type="number" step="0.01" min="0.01" [(ngModel)]="expenseForm.amount" required />
        <input name="expenseDesc" type="text" [(ngModel)]="expenseForm.description" placeholder="Description" required />
        <select name="expenseCategory" [(ngModel)]="expenseForm.categoryId" required>
          <option [ngValue]="null">Select category</option>
          <option *ngFor="let category of expenseCategories" [ngValue]="category.id">{{ category.name }}</option>
        </select>
        <button type="submit" [disabled]="expenseFormRef.invalid">Add Expense</button>
      </form>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Amount</th>
            <th>Description</th>
            <th>Category</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let txn of expenses">
            <td>{{ txn.date }}</td>
            <td>{{ txn.amount | currency }}</td>
            <td>{{ txn.description }}</td>
            <td>{{ txn.categoryName }}</td>
            <td>
              <button type="button" class="danger" (click)="deleteTransaction('EXPENSE', txn.id)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </article>

    <article>
      <h2>Add Income</h2>
      <form (ngSubmit)="addIncome()" #incomeFormRef="ngForm">
        <input name="incomeDate" type="date" [(ngModel)]="incomeForm.date" required />
        <input name="incomeAmount" type="number" step="0.01" min="0.01" [(ngModel)]="incomeForm.amount" required />
        <input name="incomeDesc" type="text" [(ngModel)]="incomeForm.description" placeholder="Description" required />
        <select name="incomeCategory" [(ngModel)]="incomeForm.categoryId" required>
          <option [ngValue]="null">Select category</option>
          <option *ngFor="let category of incomeCategories" [ngValue]="category.id">{{ category.name }}</option>
        </select>
        <button type="submit" [disabled]="incomeFormRef.invalid">Add Income</button>
      </form>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Amount</th>
            <th>Description</th>
            <th>Category</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let txn of incomes">
            <td>{{ txn.date }}</td>
            <td>{{ txn.amount | currency }}</td>
            <td>{{ txn.description }}</td>
            <td>{{ txn.categoryName }}</td>
            <td>
              <button type="button" class="danger" (click)="deleteTransaction('INCOME', txn.id)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </article>
  </div>
</section>
